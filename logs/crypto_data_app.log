2024-01-24 12:13:57,663 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:13:58,232 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/time HTTP/1.1" 200 28
2024-01-24 12:13:58,240 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:13:59,011 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706109236994&endTime=1706109237994&limit=1 HTTP/1.1" 200 163
2024-01-24 12:13:59,017 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:13:59,870 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706109177994&endTime=1706109237994&limit=1000 HTTP/1.1" 200 14839
2024-01-24 12:13:59,879 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:00,792 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706109117994&endTime=1706109177994&limit=1000 HTTP/1.1" 200 13448
2024-01-24 12:14:00,803 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:01,514 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706109057994&endTime=1706109117994&limit=1000 HTTP/1.1" 200 13291
2024-01-24 12:14:01,524 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:02,431 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108997994&endTime=1706109057994&limit=1000 HTTP/1.1" 200 14861
2024-01-24 12:14:02,442 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:02,985 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108937994&endTime=1706108997994&limit=1000 HTTP/1.1" 200 12869
2024-01-24 12:14:02,995 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:03,506 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706108936994&endTime=1706108937994&limit=1 HTTP/1.1" 200 158
2024-01-24 12:14:03,516 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:04,027 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706108936994&endTime=1706108937994&limit=1 HTTP/1.1" 200 158
2024-01-24 12:14:04,033 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:04,546 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108877994&endTime=1706108937994&limit=1000 HTTP/1.1" 200 13071
2024-01-24 12:14:04,554 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:05,067 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108817994&endTime=1706108877994&limit=1000 HTTP/1.1" 200 13463
2024-01-24 12:14:05,076 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:05,593 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108757994&endTime=1706108817994&limit=1000 HTTP/1.1" 200 15154
2024-01-24 12:14:05,605 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:06,118 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108697994&endTime=1706108757994&limit=1000 HTTP/1.1" 200 13784
2024-01-24 12:14:06,130 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:06,650 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108637994&endTime=1706108697994&limit=1000 HTTP/1.1" 200 14856
2024-01-24 12:14:06,661 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:07,165 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706108636994&endTime=1706108637994&limit=1 HTTP/1.1" 200 161
2024-01-24 12:14:07,195 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:07,701 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706108636994&endTime=1706108637994&limit=1 HTTP/1.1" 200 161
2024-01-24 12:14:07,707 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:08,234 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108577994&endTime=1706108637994&limit=1000 HTTP/1.1" 200 12986
2024-01-24 12:14:08,242 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:08,771 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108517994&endTime=1706108577994&limit=1000 HTTP/1.1" 200 15290
2024-01-24 12:14:08,782 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:09,295 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108457994&endTime=1706108517994&limit=1000 HTTP/1.1" 200 15190
2024-01-24 12:14:09,305 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:09,832 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108397994&endTime=1706108457994&limit=1000 HTTP/1.1" 200 15370
2024-01-24 12:14:09,843 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:10,357 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108337994&endTime=1706108397994&limit=1000 HTTP/1.1" 200 15001
2024-01-24 12:14:10,368 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:10,874 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706108336994&endTime=1706108337994&limit=1 HTTP/1.1" 200 160
2024-01-24 12:14:10,887 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:11,404 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706108336994&endTime=1706108337994&limit=1 HTTP/1.1" 200 160
2024-01-24 12:14:11,410 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:11,929 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108277994&endTime=1706108337994&limit=1000 HTTP/1.1" 200 14665
2024-01-24 12:14:11,938 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:12,453 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108217994&endTime=1706108277994&limit=1000 HTTP/1.1" 200 14754
2024-01-24 12:14:12,463 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:12,971 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108157994&endTime=1706108217994&limit=1000 HTTP/1.1" 200 15122
2024-01-24 12:14:12,981 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:13,497 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108097994&endTime=1706108157994&limit=1000 HTTP/1.1" 200 14937
2024-01-24 12:14:13,508 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:14,337 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706108037994&endTime=1706108097994&limit=1000 HTTP/1.1" 200 14988
2024-01-24 12:14:14,342 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:15,480 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706108036994&endTime=1706108037994&limit=1 HTTP/1.1" 200 161
2024-01-24 12:14:15,490 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:15,950 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706108036994&endTime=1706108037994&limit=1 HTTP/1.1" 200 161
2024-01-24 12:14:15,956 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:16,424 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706107977994&endTime=1706108037994&limit=1000 HTTP/1.1" 200 14617
2024-01-24 12:14:16,429 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:17,244 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706107917994&endTime=1706107977994&limit=1000 HTTP/1.1" 200 14982
2024-01-24 12:14:17,250 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:17,738 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706107857994&endTime=1706107917994&limit=1000 HTTP/1.1" 200 15242
2024-01-24 12:14:17,749 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:18,261 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706107797994&endTime=1706107857994&limit=1000 HTTP/1.1" 200 15203
2024-01-24 12:14:18,272 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:14:18,786 [DEBUG] urllib3.connectionpool: https://api.binance.com:443 "GET /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706107737994&endTime=1706107797994&limit=1000 HTTP/1.1" 200 14791
2024-01-24 12:14:18,798 [DEBUG] urllib3.connectionpool: Starting new HTTPS connection (1): api.binance.com:443
2024-01-24 12:16:56,559 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 64, in fill_dataset
    if chunk_df == None:
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/pandas/core/generic.py", line 1576, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2024-01-24 18:37:36,965 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 78, in fill_dataset
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 125, in create_crypto_dataframe
    data:dict | None = binance_trading_volume(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 63, in binance_trading_volume
    final_price: float | None = __binance_crypto_price(symbol=crypto_token,end_time_unix=end_time) #price of the crypto token at the latest date in the timeframe
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 36, in __binance_crypto_price
    return float(json_result[0][1])
                 ~~~~~~~~~~~^^^
IndexError: list index out of range
2024-01-24 18:37:38,332 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 78, in fill_dataset
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 125, in create_crypto_dataframe
    data:dict | None = binance_trading_volume(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 63, in binance_trading_volume
    final_price: float | None = __binance_crypto_price(symbol=crypto_token,end_time_unix=end_time) #price of the crypto token at the latest date in the timeframe
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 36, in __binance_crypto_price
    return float(json_result[0][1])
                 ~~~~~~~~~~~^^^
IndexError: list index out of range
2024-01-24 18:37:39,562 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 78, in fill_dataset
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 125, in create_crypto_dataframe
    data:dict | None = binance_trading_volume(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 63, in binance_trading_volume
    final_price: float | None = __binance_crypto_price(symbol=crypto_token,end_time_unix=end_time) #price of the crypto token at the latest date in the timeframe
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 36, in __binance_crypto_price
    return float(json_result[0][1])
                 ~~~~~~~~~~~^^^
IndexError: list index out of range
2024-01-24 18:38:19,193 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 78, in fill_dataset
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 125, in create_crypto_dataframe
    data:dict | None = binance_trading_volume(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 63, in binance_trading_volume
    final_price: float | None = __binance_crypto_price(symbol=crypto_token,end_time_unix=end_time) #price of the crypto token at the latest date in the timeframe
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 36, in __binance_crypto_price
    return float(json_result[0][1])
                 ~~~~~~~~~~~^^^
IndexError: list index out of range
2024-01-24 18:38:20,322 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 78, in fill_dataset
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 125, in create_crypto_dataframe
    data:dict | None = binance_trading_volume(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 63, in binance_trading_volume
    final_price: float | None = __binance_crypto_price(symbol=crypto_token,end_time_unix=end_time) #price of the crypto token at the latest date in the timeframe
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 36, in __binance_crypto_price
    return float(json_result[0][1])
                 ~~~~~~~~~~~^^^
IndexError: list index out of range
2024-01-24 18:39:03,127 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 85, in fill_dataset
    raise ValueError("data-chunk returned is none")
ValueError: data-chunk returned is none
2024-01-25 10:28:31,198 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 203, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [Errno 110] Connection timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 491, in _make_request
    raise new_e
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 467, in _make_request
    self._validate_conn(conn)
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1096, in _validate_conn
    conn.connect()
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 611, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 212, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPSConnection object at 0x7f41d2f38790>, 'Connection to api.binance.com timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706188993511&endTime=1706189083511&limit=1000 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f41d2f38790>, 'Connection to api.binance.com timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 79, in fill_dataset
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 125, in create_crypto_dataframe
    data:dict | None = binance_trading_volume(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 84, in binance_trading_volume
    response: requests.Response = requests.get("https://api.binance.com/api/v3/aggTrades", params=params)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 507, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706188993511&endTime=1706189083511&limit=1000 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f41d2f38790>, 'Connection to api.binance.com timed out. (connect timeout=None)'))
2024-01-25 10:30:44,317 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 203, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [Errno 110] Connection timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 491, in _make_request
    raise new_e
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 467, in _make_request
    self._validate_conn(conn)
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1096, in _validate_conn
    conn.connect()
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 611, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 212, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPSConnection object at 0x7f41d2dadd10>, 'Connection to api.binance.com timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706189083511&endTime=1706189173511&limit=1000 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f41d2dadd10>, 'Connection to api.binance.com timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 79, in fill_dataset
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 125, in create_crypto_dataframe
    data:dict | None = binance_trading_volume(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 84, in binance_trading_volume
    response: requests.Response = requests.get("https://api.binance.com/api/v3/aggTrades", params=params)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 507, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706189083511&endTime=1706189173511&limit=1000 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f41d2dadd10>, 'Connection to api.binance.com timed out. (connect timeout=None)'))
2024-01-25 10:32:57,438 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 203, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [Errno 110] Connection timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 491, in _make_request
    raise new_e
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 467, in _make_request
    self._validate_conn(conn)
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1096, in _validate_conn
    conn.connect()
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 611, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 212, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPSConnection object at 0x7f41d2dafed0>, 'Connection to api.binance.com timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706189172511&endTime=1706189173511&limit=1 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f41d2dafed0>, 'Connection to api.binance.com timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 79, in fill_dataset
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 125, in create_crypto_dataframe
    data:dict | None = binance_trading_volume(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 65, in binance_trading_volume
    final_price: float | None = __binance_crypto_price(symbol=crypto_token,end_time_unix=end_time) #price of the crypto token at the latest date in the timeframe
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 29, in __binance_crypto_price
    response = requests.get(url=kline_data_url, params=params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 507, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706189172511&endTime=1706189173511&limit=1 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f41d2dafed0>, 'Connection to api.binance.com timed out. (connect timeout=None)'))
2024-01-25 10:37:27,774 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 203, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [Errno 110] Connection timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 491, in _make_request
    raise new_e
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 467, in _make_request
    self._validate_conn(conn)
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1096, in _validate_conn
    conn.connect()
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 611, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 212, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPSConnection object at 0x7f204e38c450>, 'Connection to api.binance.com timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706189528170&endTime=1706189618170&limit=1000 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f204e38c450>, 'Connection to api.binance.com timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 79, in fill_dataset
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 125, in create_crypto_dataframe
    data:dict | None = binance_trading_volume(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 84, in binance_trading_volume
    response: requests.Response = requests.get("https://api.binance.com/api/v3/aggTrades", params=params)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 507, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706189528170&endTime=1706189618170&limit=1000 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f204e38c450>, 'Connection to api.binance.com timed out. (connect timeout=None)'))
2024-01-25 10:41:51,966 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 203, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [Errno 110] Connection timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 491, in _make_request
    raise new_e
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 467, in _make_request
    self._validate_conn(conn)
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1096, in _validate_conn
    conn.connect()
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 611, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 212, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPSConnection object at 0x7f0186c5ee10>, 'Connection to api.binance.com timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706189978835&endTime=1706189979835&limit=1 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f0186c5ee10>, 'Connection to api.binance.com timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 79, in fill_dataset
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 125, in create_crypto_dataframe
    data:dict | None = binance_trading_volume(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 65, in binance_trading_volume
    final_price: float | None = __binance_crypto_price(symbol=crypto_token,end_time_unix=end_time) #price of the crypto token at the latest date in the timeframe
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 29, in __binance_crypto_price
    response = requests.get(url=kline_data_url, params=params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 507, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/klines?symbol=BTCUSDT&interval=1s&startTime=1706189978835&endTime=1706189979835&limit=1 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f0186c5ee10>, 'Connection to api.binance.com timed out. (connect timeout=None)'))
2024-01-25 10:44:05,086 [ERROR] crypto_data_etl: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 203, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [Errno 110] Connection timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 790, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 491, in _make_request
    raise new_e
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 467, in _make_request
    self._validate_conn(conn)
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1096, in _validate_conn
    conn.connect()
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 611, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connection.py", line 212, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPSConnection object at 0x7f0186c5cc10>, 'Connection to api.binance.com timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/connectionpool.py", line 844, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/urllib3/util/retry.py", line 515, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706189889835&endTime=1706189979835&limit=1000 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f0186c5cc10>, 'Connection to api.binance.com timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 79, in fill_dataset
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 125, in create_crypto_dataframe
    data:dict | None = binance_trading_volume(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/crypto_apis/binance_api.py", line 84, in binance_trading_volume
    response: requests.Response = requests.get("https://api.binance.com/api/v3/aggTrades", params=params)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/de_project_env/lib/python3.11/site-packages/requests/adapters.py", line 507, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPSConnectionPool(host='api.binance.com', port=443): Max retries exceeded with url: /api/v3/aggTrades?symbol=BTCUSDT&startTime=1706189889835&endTime=1706189979835&limit=1000 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7f0186c5cc10>, 'Connection to api.binance.com timed out. (connect timeout=None)'))
2024-01-25 16:02:52,361 [ERROR] crypto_data_etl_BTC: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 77, in get_data_chunks
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 87, in create_crypto_dataframe
    raise IOError(f"crypto token not supported, heres the list of supported ones {CRYPTO_TOKEN_NAMES}")
OSError: crypto token not supported, heres the list of supported ones {'SOLUSDT', 'BTCUSDT', 'ETHUSDT'}
2024-01-25 16:02:52,862 [ERROR] crypto_data_etl_BTC: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 77, in get_data_chunks
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 87, in create_crypto_dataframe
    raise IOError(f"crypto token not supported, heres the list of supported ones {CRYPTO_TOKEN_NAMES}")
OSError: crypto token not supported, heres the list of supported ones {'SOLUSDT', 'BTCUSDT', 'ETHUSDT'}
2024-01-25 16:02:53,363 [ERROR] crypto_data_etl_BTC: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 77, in get_data_chunks
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 87, in create_crypto_dataframe
    raise IOError(f"crypto token not supported, heres the list of supported ones {CRYPTO_TOKEN_NAMES}")
OSError: crypto token not supported, heres the list of supported ones {'SOLUSDT', 'BTCUSDT', 'ETHUSDT'}
2024-01-25 16:02:53,864 [ERROR] crypto_data_etl_BTC: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 77, in get_data_chunks
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 87, in create_crypto_dataframe
    raise IOError(f"crypto token not supported, heres the list of supported ones {CRYPTO_TOKEN_NAMES}")
OSError: crypto token not supported, heres the list of supported ones {'SOLUSDT', 'BTCUSDT', 'ETHUSDT'}
2024-01-25 16:02:54,366 [ERROR] crypto_data_etl_BTC: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 77, in get_data_chunks
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 87, in create_crypto_dataframe
    raise IOError(f"crypto token not supported, heres the list of supported ones {CRYPTO_TOKEN_NAMES}")
OSError: crypto token not supported, heres the list of supported ones {'SOLUSDT', 'BTCUSDT', 'ETHUSDT'}
2024-01-25 16:02:54,867 [ERROR] crypto_data_etl_BTC: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 77, in get_data_chunks
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 87, in create_crypto_dataframe
    raise IOError(f"crypto token not supported, heres the list of supported ones {CRYPTO_TOKEN_NAMES}")
OSError: crypto token not supported, heres the list of supported ones {'SOLUSDT', 'BTCUSDT', 'ETHUSDT'}
2024-01-25 16:02:55,369 [ERROR] crypto_data_etl_BTC: failed to get a data chunk, re-trying
Traceback (most recent call last):
  File "/home/kap/first_de_project/main.py", line 77, in get_data_chunks
    chunk_df: pd.DataFrame | None = create_crypto_dataframe(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kap/first_de_project/data_processing_func.py", line 87, in create_crypto_dataframe
    raise IOError(f"crypto token not supported, heres the list of supported ones {CRYPTO_TOKEN_NAMES}")
OSError: crypto token not supported, heres the list of supported ones {'SOLUSDT', 'BTCUSDT', 'ETHUSDT'}
